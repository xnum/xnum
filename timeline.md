## 這份文件的用意

我並不怎麼喜歡所謂的美式履歷，其中的資訊太過理性、量化，在大量審閱的時候很有幫助，但並不能更深入的理解這個人的貢獻或經歷。但自傳式的內容又太過隱惡揚善，著重於博得一份工作機會。

我想用較為長篇鬆散的形式表達分享過去經歷了哪些事情，並不是作為求職用，而是在這之上的背後故事。

## ???

### 第三份工作 

期貨程式交易

---

老實說我真是討厭面試，因為一旦做過的事情我就會覺得很簡單，不怎麼提，所以常常把80分講成40分。

另外是最近刷題面試越來越多了。我就爛，不想準備，要刷題就跳過吧。

這次面試更多成分是感受這間公司是不是我會想去的，所以有一些沒來由的覺得不對盤放棄那種。

現在這公司也是莫名其妙，在104搜尋看到，第一次點應徵沒回，過了一個月覺得這職缺有點眼熟又點了一次應徵才發來邀請

然後因為懶得繼續面試了就想說先做做看吧

#### 2019

進去了我才知道現在系統的主要開發者是鹿小滑(tinlans)，因為從小到大整天泡在PTT上，加上高中學C++對於C++版的常見ID大多記得

果然這世界就是這麼小。於是開始了重拾C++進行開發的能力，各種看source code偷學。

這個時期的系統雖然能夠運行，偶而仍然有一些小bug和系統的監控告警不夠全面。

例如系統的即時狀態是沒有辦法知道的，只能進去資料庫確認，另外一些異常發生後都需要手動修補，加上資料異動的時候容易手殘是最大的問題。

循著以前做維運的經驗我加入了各種監控和日誌去加強系統的穩定度，同時也開始思索如何(砍掉重練)能做的更好。

在各種開發還有通靈各種bug之後約莫過了半年，到了年底，其實我對公司環境不是太滿意的，原因就是太吵了，很難專心工作

我甚至買了SONY那個一萬塊的抗躁耳機都沒辦法解決，痛苦半年後發生兩件事讓我決定繼續留下：加薪一萬和疫情造成的遠端工作。

#### 2020

談完之後把title改成vp，因為CTO太大了，我覺得還不是時候，還有太多東西需要學習，薪資拉到了年薪150萬附近。

在這年推出了新版的系統來解決一些基礎上的問題，同時也做了一套前後端網站去做系統控制、視覺化和數據整理。

由於小滑只會C++，但有些功能拆進go裡面做會更適合，具他本人說太多程式已經被改成他不懂的東西覺得很挫折。

因為沒有前端工程師，除了原本就很擅長的golang後端架構外又學了vue.js來自己做前後端整合，嘗試了graphql去做介面，還有各種前後端優化。

只寫後端的工程師有時候會設計出不好用的API，直到學了前端以後對於API設計我才算是完全得心應手，可以預先規劃好前端可能的使用方式，

此外就是各種大量的cache和資料預計算來不斷的加強回應速度和渲染時間，把整個網站從非常慢壓到順暢的程度。

(過度的cache是技術債 是anti pattern 慎用)

四月補了後端十月補了前端各一，在極端節省公司開支的情況下做了這個安排，比較關鍵的程式核心部分仍然是我自己扛起來。

下半年也開始思考如果架構繼續增長的狀態下，原本單機docker-compose是否可以繼續順利運作，是不是要考慮切換到kubernetes上。

自建k8s的技術需求和人力需求都是要時間培養的，雖然在雲端上點一點很方便，自有機器上要建置加上沒有可靠的夥伴是成本很高的選擇。

#### 2021

職位從VP強迫更名為CTO

機器增長到難以一台一台澆水照顧的狀態。系統也面臨單機Docker無法解決的問題：更新或機器下線的維護時間、數字踩到Docker本身的bug、網路架構受限、跨節點協調和調度困難...。開始往kubernetes的遷入計劃。

買了半櫃的中古機架伺服器和10G網路設備回來做硬體架構實驗，包含虛擬化方案、儲存設備配置、網路配置...。

嘗試架kubernetes：crio and containerd、open-rc and systemd、cgroup fs v1, v2、編譯kernel開啟各種module和support、calico, weave, multus, macvlan、各種pv、各種feature gate和admission。

##### 公司內部服務

不使用kubernetes的服務和機器需求選擇開vm解決。初期研究認為database over iscsi效能不夠好，改採超融合方式搭配SSD raid10 pool運行資料庫。其他節點運行不重要的服務。

vm server使用proxmox ve串成cluster (money aware)

kubernetes叢集使用on-perm + bare-metal建置。master node偷懶丟進vm裡面執行。一般node採用gentoo為OS。

所有節點串在一台10G switch上面走SFP+介面，形成單一L2 Network，kubernetes則使用calico作為in-cluster networking。儲存需求則在SSD raid node上使用hostPath pv。

ingress鏈路使用 pfsense (port forwarding) -> keepalived + haproxy -> NodePort -> ingress nginx -> service

全面回收和檢討IP使用，將所有服務納進統一nginx server再往後端打。

升級公司網路交換器並加大交換頻寬，從1G拉到40G。學習了各種網路知識，重新調整網段和VLAN設計。 (從taobao買了各式各樣的東西回來兜，雖然都不是我下單的)

pfsense開啟NAT reflection，廢棄內部DNS設計，使得所有公司LAN流量都可以順利存取內部服務而不需要內部DNS。

DHCP server搭配DNS forwarder實現自動註冊內部domain name，終於不用再背內部機器IP列表。

##### 公司產品

研究決定了新機房的機器規格，用來汰舊換新兼改架構。

使用kubernetes運行服務，針對底下儲存層和網路層進行強化。

網路層使用兩台Dell switch設定VLT做成active-active式HA，實體節點則用bonding作為網路介面。firewall+vpn使用pfsense HA實現 (拿了一個/28的WAN IP來用)

儲存層同樣採用hostPath pv，但備有兩台獨立節點底下運行nvme ssd raid10 pool，在軟體搭建時可選擇於兩台節點都執行程式，並用軟體內建功能達到HA。

原本預計採用zfs 2.0.x，但效能差距mdadm+LVM過大，最後棄用。

infra層將主要資料庫改用TiDB：3 PD、5 TiKV架構，搭配3 node redis + sentinel、3 node nats streaming

系統開發：

app層將大部分程式翻修為golang version，並符合運行於kubernetes上之需求特徵 (alive/ready probe, prometheus metrics, stateless, logging)

snowflake algorithm微調改採POD IP替代原本的instance ID設計，修改程式為deployment方式運作並搭配程式化控制pod auto scaling。

程式內部使用multus + macvlan CNI組合進行網路連外微加速。

##### 人員訓練

痛定思痛導入gerrit + jenkins，實行per commit review。

### 2018-06 ~ 2019-05 第二份工作

那時候學弟說要上來台北聊天，我也打算去找他聚一下，然後就莫名其妙的跑到了101 39樓，

聽說是做虛擬貨幣交易所的，剛好我那時候也在研究交易系統的設計，就一起跟人家的CTO聊了天，

事後HR問我想不想來面試，本來想推掉的，但是人家說很希望可以來面一下，於是我就掰了一個理由請假跑去了。

那天面試從下午一點戰到晚上八點，結束的時候公司的人都走光了

後來我就換工作了，改跑去做交易所的後端。

#### 2018

剛進去的我是啥也不會，壓力爆表，聽說還有同事進來三天就看完公司的code base，深感自己是真D弱

從golang基礎開始學，幸好有mentor小新特別罩，也有完整的code review制度，所以還算是能pick up

當時的我第一次學docker還有git用gerrit的一些進階用法，幸好同期有個實驗室同學oscar早我一點進同公司

就厚著臉皮問他怎麼寫dockerfile，然後看command history慢慢研究，怎麼做新版的container image再佈署到dev k8s環境上

常常寫了code開CL上去以後就會有各路大神跑進來參觀指教，被迫安裝了很多新知識。

可以說真正的如何做後端都啟蒙於這個時間點。

---

由於後端也沒那麼多功能要做，加上那時候百家爭鳴，能支援越多幣越能吸引人，所以我也踏上了接鍊之路

開始了研究怎麼讓交易所可以支援一種區塊鍊系統，於是重新學習了加密簽章演算法...

研究完以後還報告給大家聽這個鍊的特點，又是一次壓力爆表，是一段每天腦子都要轉得很快的日子

#### 2019

過了半年適逢公司重心轉移，想把人員拉去做區塊鍊，剛好我也對交易所該學的都學了

於是就被拉去負責交易所team和參與維運，具體來說一是進度和人員管理、指派工作

二是學習deploy還有troubleshooting：因為交易所prod環境涉及錢包密鑰，公司只有三個人能存取

所以發生問題時如果需要鑽進去看，我就逐漸成為那個負責鑽進去的人，而日常維運就還是SRE處理

也因此學了不少k8s操作和經驗。第一次實際接手了production環境維運，現在想起來還有點小興奮呢。

在離開時年薪來到了一百二十萬


### 2017-06 ~ 2018-06 第一份工作

面試部分詳情請看2017年的面試心得，總之當時只會C/C++，其他語言會寫但是不精的情況下還是跑去做C/C++的工作

在櫃買中心當系統開發人員 (俗稱 AP 應用程式)，主要內容就是程式開發相關的工作，佈署維運交給網路組

因為其他offer的年薪不夠高所以我就跑去那邊啦～46k 領滿18個月，第一年獎金沒滿，實際上做一年下來只領了80萬不到

由於上市上櫃是交給證交所處理，這邊只開發興櫃、債券、衍生品和他們的報價行情系統，主要就是用古老的C寫出來的

跑在很古老的Solaris系統上運作。老實說就是拼裝車，因為那個年代也沒有什麼軟體工程概念就是硬幹，二十年前寫好後就傳承至今，

開發就像在玩不定時炸彈。不過在這邊工作也有個好處就是不趕時程加上很多老問題尚待解決，所以我嘗試研究了很多問題，

也學習了不少東西，包含工作上需要的還有業務相關我自己跑去學的，那個時期寫的blog都是在解一些莫名其妙的東西。

做這工作真是讓我培養了不少通靈技能，因為發生狀況往往只能透過截圖或log檔保留一些現場，然後就要馬上重啟想辦法復原，

而大多數情況下也不是可以重現的，所以常常要用事後分析的方式定位可能的發生原因，通靈王的稱號大概也是從這時候開始的。


在這邊工作有幾個讓我很受不了的地方，第一點是必須要穿襯衫加西裝褲，第二點是打卡+九點前一定要到，第三點是要值班早上七點前到公司

第四點是開發維運分離，有問題就是你程式寫不好，第五點是桌上有電話有人可能會打給你，第六點也是我最傻眼的一點就是要負責辦餐會

話說每一季都會有一個勵進會的東西，要想一點節目還有請外燴來公司裡，但是我記得我是來應徵寫程式不是來應徵福委會的吧

剛好那時候有個機會所以我就離職了


## 研究所 

研究所以前的記錄僅是事後追憶，記載一些人生重大的事件或趣事，其來源多半為零散的信件、披兔隱藏舊文，或有主觀或個人情感色彩。

### 修課

我是第一屆的戊組推甄進去的，那時候交大的畢業學分是24分，由於大部分偏理論的課我完全不行，所以當初選的全部是實作型課程 (programming結尾的)

要求一門英文授課，有投影片的情況下只聽一半懂還是可以順利pass，考券可以寫中文所以英文爛也沒太大困擾，畢業也沒有英文考試要求

所以儘管研究所畢業，我的英文聽說還是爛的可以，寫的也不怎麼樣

### 工作

戊組除了上課以外另一項義務就是當PT勞力，當時每學期都可以兼到兩三個計畫名額，每個月一兩萬塊剛好可以應付學費+吃飯+租房

常態性兼職的是程式檢定助教，大概就是系上程式考試的時候幫忙巡場講解題目或給予適當幫助

另外就是幫忙學校裡面的單位開發一些網站，第一個兼差的是師陪中心的一個網站，這也是第一次學MVC開始寫網站，用Laravel

以前都是寫前後端黏在一起的噁心PHP程式碼，這算是第一次用上了現代的東西。

後來幫忙作了一個自動讓教職員學生可以申請office和gmail教育版的網站，就串學校的SSO打個api開帳號，

為了做這個網站拿了許多管理員權限，不過我是個正義的人，是不會拿來做壞事的！

### 生活

也因為這個戊組的緣故，除了研究生會在實驗室有個位置之外，我在校計中的三樓房間裡也有一個位置，我大部分的時間都是待在校計中

只有實驗室meeting的時候會大家一起在二樓的會議室開會。比起大部分人比較懷念實驗室，我反而比較懷念校計中。

每個戊組同學都會拿到一把辦公室鑰匙，很爛的喇叭鎖那種，那對我的意義就像自己在學校的一個小天地，或是曾經住過的一個家一樣。

反正有免錢的冷氣可以吹+有電腦可以打遊戲上網，而且到二餐買東西、樓下買鬆餅飲料也近，不知道在那裡混了多少個深夜的日子

常常晚上12點附近走到機車停車場，再騎光復路回去睡覺。

### 論文

論文完全是老師說了算，雖然我本來就是個喜歡主動探索一些莫名其妙東西的人，不過也要感謝老師支持做這個題目也沒有為難

從現在的我來看的話這算是做的很粗糙的。寫著寫著順利的就四月口試五月離校了

我還特地把圖書館寄給我的［電子論文審核通過通知單］給留在gmail裡面，直到現在都還可以體會到我當初收到這封信有多開心

因為這代表我幾十年地獄般的求學生涯終於結束了。

### 後記

沒用到的東西就逐漸忘記，現在很多演算法跟leetcode題目應該都沒辦法快速寫出來了，只剩下到處copy人家程式的能力

看了一下丁戊組的性向測驗感覺好難QQ，我還是只會1/3~1/2，反正工作用到再去學吧，實際上在學校裡也沒學到或用到那麼多東西就是了

大概也是沒資深工程師當mentor的緣故吧或是沒興趣做，什麼都自己摸也沒人帶入門效率就很差，也不會知道有什麼更好的做法或技術。

好像現在一堆校務系統的東西都是Laravel，仔細想想好像跟我(們)脫離不了關係，畢竟當年不知道為啥就決定用了這個抱歉啦。

現在的話我應該完全anti這種動態型別語言吧，我還是喜歡go比較多啦，再不濟也要用.net吧。
